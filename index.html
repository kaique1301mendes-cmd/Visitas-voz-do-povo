<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Voz do Povo Arapoti - Transmiss√µes</title>
<style>
body{font-family:Arial;background:#121212;color:#fff;margin:0;padding:0;}
header{background:#b30000;padding:15px;text-align:center;}
h1{margin:0;font-size:24px;}
nav{display:flex;justify-content:center;background:#222;}
nav button{padding:10px 20px;margin:5px;background:#444;color:#fff;border:none;cursor:pointer;border-radius:5px;}
nav button.active{background:#b30000;}
main{max-width:900px;margin:auto;padding:20px;}
.game-card{background:#1e1e1e;padding:15px;border-radius:10px;margin-bottom:15px;border:1px solid #333;}
h3{color:#ff3333;margin:0 0 5px 0;}
iframe,video{width:100%;height:400px;margin-top:10px;border-radius:10px;border:none;}
</style>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
</head>
<body>
<header><h1>Voz do Povo Arapoti - Transmiss√µes Ao Vivo</h1></header>

<nav>
  <button onclick="mostrarCategoria('esportes')" class="active">‚öΩ Esportes</button>
  <button onclick="mostrarCategoria('noticias')">üì∞ Not√≠cias</button>
  <button onclick="mostrarCategoria('cultura')">üé≠ Cultura</button>
</nav>

<main id="lista"></main>

<script>
// carrega os links cadastrados no admin
const jogos = JSON.parse(localStorage.getItem("jogosFutebol") || "[]");
let categoriaAtual = "esportes";

// Fun√ß√£o para converter link em embed autom√°tico
function criarEmbed(link, id){
  // YouTube
  if(link.includes("youtube.com") || link.includes("youtu.be")){
    let videoId="";
    if(link.includes("watch?v=")) videoId=link.split("v=")[1].split("&")[0];
    else if(link.includes("live/")) videoId=link.split("live/")[1].split("?")[0];
    else if(link.includes("youtu.be/")) videoId=link.split("youtu.be/")[1].split("?")[0];
    return `<iframe src="https://www.youtube.com/embed/${videoId}" allowfullscreen></iframe>`;
  }
  // Twitch
  if(link.includes("twitch.tv/")){
    const canal = link.split("twitch.tv/")[1].split("/")[0];
    return `<iframe src="https://player.twitch.tv/?channel=${canal}&parent=localhost" allowfullscreen></iframe>`;
  }
  // IPTV .m3u8
  if(link.endsWith(".m3u8")){
    return `<video id="video-${id}" controls autoplay></video>
    <script>
      (function(){
        const video=document.getElementById("video-${id}");
        if(Hls.isSupported()){
          const hls=new Hls();
          hls.loadSource("${link}");
          hls.attachMedia(video);
        }else if(video.canPlayType("application/vnd.apple.mpegurl")){
          video.src="${link}";
        }
      })();
    <\/script>`;
  }
  return `<a href="${link}" target="_blank">Abrir transmiss√£o</a>`;
}

function render(){
  const lista=document.getElementById("lista");
  lista.innerHTML="";
  const filtrados=jogos.filter(j=>j.categoria===categoriaAtual);
  if(filtrados.length===0){
    lista.innerHTML="<p>Nenhum conte√∫do dispon√≠vel nesta categoria.</p>";
    return;
  }
  filtrados.forEach((j,index)=>{
    const card=document.createElement("div");
    card.className="game-card";
    card.innerHTML=`
      <h3>${j.titulo}</h3>
      ${criarEmbed(j.link, index)}
    `;
    lista.appendChild(card);
  });
}

function mostrarCategoria(cat){
  categoriaAtual=cat;
  document.querySelectorAll("nav button").forEach(btn=>btn.classList.remove("active"));
  document.querySelector(`nav button[onclick*="${cat}"]`).classList.add("active");
  render();
}

render();
</script>
</body>
</html>